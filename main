-- Создаем ScreenGui в StarterGui
local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.Name = "CustomClickGUI"

-- Создаем основной фрейм с увеличенными размерами
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 600, 0, 500)
mainFrame.Position = UDim2.new(0.5, -300, 0.5, -250)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
mainFrame.Visible = true

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = mainFrame

local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(50, 50, 50)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 20, 20))
}
gradient.Rotation = 45
gradient.Parent = mainFrame

local stroke = Instance.new("UIStroke")
stroke.Thickness = 2
stroke.Color = Color3.fromRGB(0, 0, 0)
stroke.Transparency = 0.7
stroke.Parent = mainFrame

-- Drag-and-drop с UserInputService
local dragging = false
local dragStart = nil
local startPos = nil
local UserInputService = game:GetService("UserInputService")

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
        local delta = input.Position - dragStart
        local newPos = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        game.TweenService:Create(mainFrame, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Position = newPos}):Play()
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Открытие/закрытие на Insert
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.Insert then
        mainFrame.Visible = not mainFrame.Visible
    end
end)

-- Панель для основных вкладок (слева)
local sectionPanel = Instance.new("Frame")
sectionPanel.Size = UDim2.new(0, 150, 1, 0)
sectionPanel.Position = UDim2.new(0, 0, 0, 0)
sectionPanel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
sectionPanel.BorderSizePixel = 0
sectionPanel.Parent = mainFrame

local sectionCorner = Instance.new("UICorner")
sectionCorner.CornerRadius = UDim.new(0, 10)
sectionCorner.Parent = sectionPanel

-- Область контента (справа)
local contentArea = Instance.new("Frame")
contentArea.Size = UDim2.new(0, 450, 1, 0)
contentArea.Position = UDim2.new(0, 150, 0, 0)
contentArea.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
contentArea.BorderSizePixel = 0
contentArea.Parent = mainFrame

local contentCorner = Instance.new("UICorner")
contentCorner.CornerRadius = UDim.new(0, 10)
contentCorner.Parent = contentArea

-- Панель для подвкладок с прокруткой
local subSectionPanel = Instance.new("ScrollingFrame")
subSectionPanel.Size = UDim2.new(1, 0, 0, 60)
subSectionPanel.Position = UDim2.new(0, 0, 0, 0)
subSectionPanel.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
subSectionPanel.BorderSizePixel = 0
subSectionPanel.ScrollBarThickness = 4
subSectionPanel.CanvasSize = UDim2.new(0, 0, 0, 0)
subSectionPanel.Parent = contentArea
subSectionPanel.Visible = false

local subSectionCorner = Instance.new("UICorner")
subSectionCorner.CornerRadius = UDim.new(0, 8)
subSectionCorner.Parent = subSectionPanel

-- Область настроек (под подвкладками)
local settingsArea = Instance.new("Frame")
settingsArea.Size = UDim2.new(1, 0, 1, -60)
settingsArea.Position = UDim2.new(0, 0, 0, 60)
settingsArea.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
settingsArea.BorderSizePixel = 0
settingsArea.Parent = contentArea

local settingsCorner = Instance.new("UICorner")
settingsCorner.CornerRadius = UDim.new(0, 8)
settingsCorner.Parent = settingsArea

-- Данные о секциях и подвкладках с фиксированным порядком
local sections = {
    {name = "AimBot", subSections = {"Silent", "Camlock", "Bullet", "Rage", "Legit", "Trigger"}},
    {name = "AntiAim", subSections = {"Desync", "Spin", "Jitter", "FakePitch", "Invert"}},
    {name = "Movement", subSections = {"Speed", "BunnyHop", "Flight", "NoClip", "Teleport"}},
    {name = "PlayerSettings", subSections = {"ESP", "Chams", "Health", "FOV", "Tracers"}},
    {name = "Misc", subSections = {"KillSay", "AutoClick", "FakeLag", "ChatSpam", "Exploits"}},
    {name = "UiSettings", subSections = {"Theme", "Keybinds", "Reset", "Scale", "Colors"}}
}

local sectionButtons = {}
local subSectionButtons = {}

-- Функция создания кнопок подвкладок с прокруткой
local function createSubSections(sectionName)
    for _, btn in pairs(subSectionButtons) do
        btn:Destroy()
    end
    subSectionButtons = {}
    subSectionPanel.Visible = true

    local subSections
    for _, section in ipairs(sections) do
        if section.name == sectionName then
            subSections = section.subSections
            break
        end
    end

    local buttonWidth = 90
    local buttonHeight = 40
    local padding = 5
    local totalWidth = (#subSections * (buttonWidth + padding)) - padding
    subSectionPanel.CanvasSize = UDim2.new(0, totalWidth, 0, 0)

    for i, subSectionName in ipairs(subSections) do
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(0, buttonWidth, 0, buttonHeight)
        button.Position = UDim2.new(0, (i - 1) * (buttonWidth + padding), 0, 10)
        button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        button.BorderSizePixel = 0
        button.Text = subSectionName
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.TextSize = 14
        button.Font = Enum.Font.Gotham
        button.Parent = subSectionPanel

        local btnCorner = Instance.new("UICorner")
        btnCorner.CornerRadius = UDim.new(0, 6)
        btnCorner.Parent = button

        button.MouseEnter:Connect(function()
            game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 100)}):Play()
        end)
        button.MouseLeave:Connect(function()
            if button ~= subSectionButtons.active then
                game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
            end
        end)

        button.MouseButton1Click:Connect(function()
            if subSectionButtons.active then
                game.TweenService:Create(subSectionButtons.active, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
            end
            subSectionButtons.active = button
            game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(120, 120, 120)}):Play()

            for _, child in pairs(settingsArea:GetChildren()) do
                child:Destroy()
            end
            local settingsLabel = Instance.new("TextLabel")
            settingsLabel.Size = UDim2.new(1, 0, 1, 0)
            settingsLabel.BackgroundTransparency = 1
            settingsLabel.Text = "Настройки для " .. subSectionName
            settingsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            settingsLabel.TextSize = 18
            settingsLabel.Font = Enum.Font.Gotham
            settingsLabel.Parent = settingsArea
        end)

        table.insert(subSectionButtons, button)
    end

    if #subSectionButtons > 0 then
        subSectionButtons[1]:MouseButton1Click()
    end
end

-- Создаем основные вкладки
for i, section in ipairs(sections) do
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, -10, 0, 50)
    button.Position = UDim2.new(0, 5, 0, (i - 1) * 55 + 5)
    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    button.BorderSizePixel = 0
    button.Text = section.name
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 18
    button.Font = Enum.Font.GothamBold
    button.Parent = sectionPanel

    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 8)
    btnCorner.Parent = button

    local btnGradient = Instance.new("UIGradient")
    btnGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(80, 80, 80)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(50, 50, 50))
    }
    btnGradient.Parent = button

    button.MouseEnter:Connect(function()
        game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 100)}):Play()
    end)
    button.MouseLeave:Connect(function()
        if button ~= sectionButtons.active then
            game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
        end
    end)

    button.MouseButton1Click:Connect(function()
        if sectionButtons.active then
            game.TweenService:Create(sectionButtons.active, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
        end
        sectionButtons.active = button
        game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(120, 120, 120)}):Play()

        createSubSections(section.name)
    end)

    table.insert(sectionButtons, button)
end

-- Активируем первую вкладку ("AimBot")
sectionButtons[1]:MouseButton1Click()
