-- Создаем ScreenGui в StarterGui
local player = game.Players.LocalPlayer
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.Name = "CustomClickGUI"

-- Создаем основной фрейм (увеличиваем ширину на 200)
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 800, 0, 500) -- Было 600, стало 800
mainFrame.Position = UDim2.new(-1, -800, 0.5, -250) -- Смещаем начальную позицию
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
mainFrame.Visible = false

-- Градиентная линия сверху основного фрейма
local topLine = Instance.new("Frame")
topLine.Size = UDim2.new(1, 0, 0, 3)
topLine.Position = UDim2.new(0, 0, 0, 0)
topLine.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
topLine.BorderSizePixel = 0
topLine.Parent = mainFrame

local lineGradient = Instance.new("UIGradient")
lineGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 162, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 255, 209))
}
lineGradient.Rotation = 0
lineGradient.Parent = topLine

local stroke = Instance.new("UIStroke")
stroke.Thickness = 2
stroke.Color = Color3.fromRGB(0, 0, 0)
stroke.Transparency = 0.7
stroke.Parent = mainFrame

-- Drag-and-drop
local dragging = false
local dragStart = nil
local startPos = nil
local UserInputService = game:GetService("UserInputService")

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
        local delta = input.Position - dragStart
        local newPos = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        game.TweenService:Create(mainFrame, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Position = newPos}):Play()
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Панель для основных вкладок
local sectionPanel = Instance.new("Frame")
sectionPanel.Size = UDim2.new(0, 150, 1, 0)
sectionPanel.Position = UDim2.new(0, 0, 0, 0)
sectionPanel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
sectionPanel.BorderSizePixel = 0
sectionPanel.Parent = mainFrame

-- Область контента (увеличиваем ширину)
local contentArea = Instance.new("Frame")
contentArea.Size = UDim2.new(0, 650, 1, 0) -- Было 450, стало 650
contentArea.Position = UDim2.new(0, 150, 0, 0)
contentArea.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
contentArea.BorderSizePixel = 0
contentArea.Parent = mainFrame

-- Панель для подвкладок с прокруткой
local subSectionPanel = Instance.new("ScrollingFrame")
subSectionPanel.Size = UDim2.new(1, 0, 0, 60)
subSectionPanel.Position = UDim2.new(0, 0, 0, 0)
subSectionPanel.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
subSectionPanel.BorderSizePixel = 0
subSectionPanel.ScrollBarThickness = 4
subSectionPanel.CanvasSize = UDim2.new(0, 0, 0, 0)
subSectionPanel.Parent = contentArea
subSectionPanel.Visible = false

-- Область настроек
local settingsArea = Instance.new("Frame")
settingsArea.Size = UDim2.new(1, 0, 1, -60)
settingsArea.Position = UDim2.new(0, 0, 0, 60)
settingsArea.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
settingsArea.BorderSizePixel = 0
settingsArea.Parent = contentArea

-- Данные о секциях и подвкладках
local sections = {
    {name = "AimBot", subSections = {"Silent", "Camlock", "Bullet", "Rage", "Legit", "Trigger"}},
    {name = "AntiAim", subSections = {"Desync", "Spin", "Jitter", "FakePitch", "Invert"}},
    {name = "Movement", subSections = {"Speed", "BunnyHop", "Flight", "NoClip", "Teleport"}},
    {name = "PlayerSettings", subSections = {"ESP", "Chams", "Health", "FOV", "Tracers"}},
    {name = "Misc", subSections = {"KillSay", "AutoClick", "FakeLag", "ChatSpam", "Exploits"}},
    {name = "UiSettings", subSections = {"Theme", "Keybinds", "Reset", "Scale", "Colors"}}
}

local sectionButtons = {}
local subSectionButtons = {}

-- Функция создания кнопок подвкладок
local function createSubSections(sectionName)
    for _, btn in pairs(subSectionButtons) do
        btn:Destroy()
    end
    subSectionButtons = {}
    subSectionPanel.Visible = true

    local subSections
    for _, section in ipairs(sections) do
        if section.name == sectionName then
            subSections = section.subSections
            break
        end
    end

    local buttonSize = 50 -- Квадратные кнопки 50x50
    local padding = 5
    local totalWidth = (#subSections * (buttonSize + padding)) - padding
    subSectionPanel.CanvasSize = UDim2.new(0, totalWidth, 0, 0)

    for i, subSectionName in ipairs(subSections) do
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(0, buttonSize, 0, buttonSize) -- Квадратные
        button.Position = UDim2.new(0, (i - 1) * (buttonSize + padding), 0, 5)
        button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        button.BorderSizePixel = 0
        button.Text = subSectionName
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.TextSize = 14
        button.Font = Enum.Font.Gotham
        button.Parent = subSectionPanel

        -- Градиентная линия сверху кнопки
        local btnTopLine = Instance.new("Frame")
        btnTopLine.Size = UDim2.new(1, 0, 0, 2)
        btnTopLine.Position = UDim2.new(0, 0, 0, 0)
        btnTopLine.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        btnTopLine.BorderSizePixel = 0
        btnTopLine.Parent = button

        local btnLineGradient = Instance.new("UIGradient")
        btnLineGradient.Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 162, 255)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 255, 209))
        }
        btnLineGradient.Rotation = 0
        btnLineGradient.Parent = btnTopLine

        button.MouseEnter:Connect(function()
            game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 100)}):Play()
        end)
        button.MouseLeave:Connect(function()
            if button ~= subSectionButtons.active then
                game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
            end
        end)

        button.MouseButton1Click:Connect(function()
            if subSectionButtons.active then
                game.TweenService:Create(subSectionButtons.active, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
            end
            subSectionButtons.active = button
            game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(120, 120, 120)}):Play()

            for _, child in pairs(settingsArea:GetChildren()) do
                game.TweenService:Create(child, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {TextTransparency = 1}):Play()
                task.wait(0.2)
                child:Destroy()
            end
            local settingsLabel = Instance.new("TextLabel")
            settingsLabel.Size = UDim2.new(1, 0, 1, 0)
            settingsLabel.BackgroundTransparency = 1
            settingsLabel.Text = "Настройки для " .. subSectionName
            settingsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            settingsLabel.TextSize = 18
            settingsLabel.Font = Enum.Font.Gotham
            settingsLabel.TextTransparency = 1
            settingsLabel.Parent = settingsArea
            game.TweenService:Create(settingsLabel, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0}):Play()
        end)

        table.insert(subSectionButtons, button)
    end

    if #subSectionButtons > 0 then
        subSectionButtons[1]:MouseButton1Click()
    end
end

-- Создаем основные вкладки
for i, section in ipairs(sections) do
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, -10, 0, 40)
    button.Position = UDim2.new(0, 5, 0, (i - 1) * 45 + 5)
    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    button.BorderSizePixel = 0
    button.Text = section.name
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 18
    button.Font = Enum.Font.GothamBold
    button.Parent = sectionPanel

    -- Градиентная линия сверху кнопки
    local btnTopLine = Instance.new("Frame")
    btnTopLine.Size = UDim2.new(1, 0, 0, 2)
    btnTopLine.Position = UDim2.new(0, 0, 0, 0)
    btnTopLine.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    btnTopLine.BorderSizePixel = 0
    btnTopLine.Parent = button

    local btnLineGradient = Instance.new("UIGradient")
    btnLineGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 162, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 255, 209))
    }
    btnLineGradient.Rotation = 0
    btnLineGradient.Parent = btnTopLine

    button.MouseEnter:Connect(function()
        game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 100)}):Play()
    end)
    button.MouseLeave:Connect(function()
        if button ~= sectionButtons.active then
            game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
        end
    end)

    button.MouseButton1Click:Connect(function()
        if sectionButtons.active then
            game.TweenService:Create(sectionButtons.active, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
        end
        sectionButtons.active = button
        game.TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(120, 120, 120)}):Play()

        createSubSections(section.name)
    end)

    table.insert(sectionButtons, button)
end

-- Анимация открытия/закрытия на Insert
local isOpen = false
local function toggleGUI()
    local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
    
    if isOpen then
        -- Анимация закрытия
        if subSectionPanel.Visible then
            subSectionPanel.Visible = false
        end
        if sectionButtons.active then
            game.TweenService:Create(sectionButtons.active, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
            sectionButtons.active = nil
        end
        for _, child in pairs(settingsArea:GetChildren()) do
            child:Destroy()
        end
        
        local mainTween = game.TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(-1, -800, 0.5, -250)}) -- Учитываем новую ширину
        mainTween:Play()
        mainTween.Completed:Connect(function()
            mainFrame.Visible = false
        end)
    else
        -- Анимация открытия
        mainFrame.Visible = true
        mainFrame.Position = UDim2.new(-1, -800, 0.5, -250) -- Учитываем новую ширину
        local mainTween = game.TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(0.5, -400, 0.5, -250)}) -- Центрируем с учетом ширины 800
        mainTween:Play()
        mainTween.Completed:Connect(function()
            sectionButtons[1]:MouseButton1Click()
        end)
    end
    isOpen = not isOpen
end

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.Insert then
        toggleGUI()
    end
end)

-- Открываем GUI при запуске
toggleGUI()
